language: cpp

dist: bionic
os: linux

jobs:
  include:
    - arch:
        - amd64
        - arm64
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-8
      env:
        - MATRIX_EVAL="CC=gcc-8 && CXX=g++-8"

git:
  depth: 1

before_install:
    - sudo apt-get update
    - sudo apt-get install linux-libc-dev
    - sudo apt-get install git
    - sudo apt-get install build-essential
    - sudo apt-get install automake
    - sudo apt-get install libtool
    - sudo apt-get install python-dev
    - sudo apt-get install zlib1g-dev
    - sudo apt-get install gettext
    - sudo apt-get install swig
    - sudo apt-get install libgstreamer1.0-dev
    - sudo apt-get install libgstreamer-plugins-base1.0-dev
    - sudo apt-get install libfreetype6-dev
    - sudo apt-get install libsigc++-2.0-dev
    - sudo apt-get install libfribidi-dev
    - sudo apt-get install libssl-dev
    - sudo apt-get install libavahi-client-dev
    - sudo apt-get install libjpeg-turbo8-dev
    - sudo apt-get install libgif-dev
    - eval "${MATRIX_EVAL}"

script:
- echo installing libdvbsi++
- pushd .
- cd /tmp
- git clone --depth 1 git://git.opendreambox.org/git/obi/libdvbsi++.git
- cd libdvbsi++
- autoreconf -i
- ./configure
- make
- sudo make install
- popd
- echo installing tuxbox
- pushd .
- cd /tmp
- git clone --depth 1 https://github.com/OpenPLi/tuxtxt.git
- cd tuxtxt/libtuxtxt
- autoreconf -i
- ./configure --with-boxtype=generic DVB_API_VERSION=5
- make
- sudo make install
- cd ../tuxtxt
- autoreconf -i
- ./configure --with-boxtype=generic DVB_API_VERSION=5
- make
- sudo make install
- popd
- echo compiling enigma2
- autoreconf -i
- ./configure --with-libsdl=no --with-boxtype=nobox --enable-dependency-tracking ac_cv_prog_c_openmp=-fopenmp --with-gstversion=1.0 --with-textlcd
- make
- python -m compileall .
- echo done!

